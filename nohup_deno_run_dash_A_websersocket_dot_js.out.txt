starging server with o_config
n_port: 8080
b_https: false
s_hostname: localhost
f_v_before_return_response: async function(o_request){
    // important if the connection is secure (https),
    // the socket has to be opened with the wss:// protocol
    // from the client
    // for client: const socket = new WebSocket(`${window.location.protocol.replace('http', 'ws')}//${window.location.host}`);

    let o_url = new URL(o_request.url);
    let o_request_data = null;
    try {
        o_request_data = (await o_request.json())
    } catch (error) {
    }
    let a_s_name_funtion = Object.keys(o_s_name_function_f__exposed);
    if(o_request_data?.s_name_function){

        let f = o_s_name_function_f__exposed[o_request_data.s_name_function];
        if(!f){
            return new Response(
                JSON.stringify(
                    {
                        b_success: false, 
                        s_msg: `function '${o_request_data.s_name_function}' is not available , available are ${a_s_name_funtion.join(',')}`
                    }
                )
            )
        }
        if(f){
            return await f(o_request_data?.o_param)
        }
    }
    

    if(o_url.pathname == '/'){

        return new Response(
            await Deno.readTextFile(
                `${s_path_folder_current}/localhost/client.html`
            ),
            { 
                headers: {
                    'Content-type': "text/html"
                }
            }
        );
    }
    if(o_url.pathname == '/stream'){

        let timer = undefined;
        const body = new ReadableStream({
          start(controller) {
            timer = setInterval(() => {
              const message = `It is ${new Date().toISOString()}\n`;
              controller.enqueue(new TextEncoder().encode(message));
            }, 1000);
          },
          cancel() {
            if (timer !== undefined) {
              clearInterval(timer);
            }
          },
        });
        return new Response(body, {
          headers: {
            "content-type": "text/plain",
            "x-content-type-options": "nosniff",
          },
        });
        
    }


    return f_v_before_return_response__fileserver(
        o_request,
        `${s_path_folder_current}/localhost/`
    )
}
port: 8080
hostname: localhost
Listening on http://localhost:8080/
starging server with o_config
n_port: 8443
b_https: true
s_hostname: localhost
f_v_before_return_response: async function(o_request){
    // important if the connection is secure (https),
    // the socket has to be opened with the wss:// protocol
    // from the client
    // for client: const socket = new WebSocket(`${window.location.protocol.replace('http', 'ws')}//${window.location.host}`);

    let o_url = new URL(o_request.url);
    let o_request_data = null;
    try {
        o_request_data = (await o_request.json())
    } catch (error) {
    }
    let a_s_name_funtion = Object.keys(o_s_name_function_f__exposed);
    if(o_request_data?.s_name_function){

        let f = o_s_name_function_f__exposed[o_request_data.s_name_function];
        if(!f){
            return new Response(
                JSON.stringify(
                    {
                        b_success: false, 
                        s_msg: `function '${o_request_data.s_name_function}' is not available , available are ${a_s_name_funtion.join(',')}`
                    }
                )
            )
        }
        if(f){
            return await f(o_request_data?.o_param)
        }
    }
    

    if(o_url.pathname == '/'){

        return new Response(
            await Deno.readTextFile(
                `${s_path_folder_current}/localhost/client.html`
            ),
            { 
                headers: {
                    'Content-type': "text/html"
                }
            }
        );
    }
    if(o_url.pathname == '/stream'){

        let timer = undefined;
        const body = new ReadableStream({
          start(controller) {
            timer = setInterval(() => {
              const message = `It is ${new Date().toISOString()}\n`;
              controller.enqueue(new TextEncoder().encode(message));
            }, 1000);
          },
          cancel() {
            if (timer !== undefined) {
              clearInterval(timer);
            }
          },
        });
        return new Response(body, {
          headers: {
            "content-type": "text/plain",
            "x-content-type-options": "nosniff",
          },
        });
        
    }


    return f_v_before_return_response__fileserver(
        o_request,
        `${s_path_folder_current}/localhost/`
    )
}
port: 8443
hostname: localhost
cert: ***
key: ***
Listening on https://localhost:8443/
server(s) running:
   http://localhost:8080
   https://localhost:8443
{
  model: "dall-e-2",
  size: "1024x1024",
  n: 1,
  prompt: "an elephant on a horse"
}
{
  model: "dall-e-2",
  size: "1024x1024",
  n: 1,
  prompt: "an elephant on a horse"
}
{
  model: "dall-e-2",
  size: "1024x1024",
  n: 1,
  prompt: "an elephant on a horse"
}
{
  model: "dall-e-2",
  size: "1024x1024",
  n: 1,
  prompt: "an elephant on a horse"
}
{
  model: "dall-e-2",
  size: "1024x1024",
  n: 1,
  prompt: "Estimated costs"
}
{ model: "dall-e-2", size: "1024x1024", n: 1, prompt: "a nice graph" }
{
  model: "dall-e-2",
  size: "1024x1024",
  n: 1,
  prompt: "okkeeeey lets go!"
}
{
  model: "dall-e-3",
  size: "1024x1024",
  quality: "standard",
  n: 1,
  prompt: "a logo for my new webapplication which is a consumer for an API"
}
